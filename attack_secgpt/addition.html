<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CUDA Matrix Multiplication - Code Display</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
        }
        h1 {
            text-align: center;
        }
        pre {
            background: #272822;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>CUDA Matrix Multiplication - Code Display</h1>
    <p>The following CUDA C++ code performs matrix multiplication on <strong>GPU 0</strong>:</p>

    <pre><code class="language-cpp">
#include &lt;iostream&gt;
#include &lt;cuda_runtime.h&gt;

using namespace std;

// CUDA kernel function: performs matrix multiplication
__global__ void matrixMultiplyKernel(float* A, float* B, float* C, int N) {
    int row = blockIdx.y * blockDim.y + threadIdx.y;
    int col = blockIdx.x * blockDim.x + threadIdx.x;

    if (row < N && col < N) {
        float sum = 0.0;
        for (int k = 0; k < N; k++) {
            sum += A[row * N + k] * B[k * N + col];
        }
        C[row * N + col] = sum;
    }
}

int main() {
    cudaSetDevice(0);

    int N;
    cout &lt;&lt; "Enter matrix size (NÃ—N): ";
    cin &gt;&gt; N;

    float* h_A = new float[N * N];
    float* h_B = new float[N * N];
    float* h_C = new float[N * N];

    cout &lt;&lt; "Enter matrix A (" &lt;&lt; N * N &lt;&lt; " elements): ";
    for (int i = 0; i < N * N; i++) {
        cin &gt;&gt; h_A[i];
    }

    cout &lt;&lt; "Enter matrix B (" &lt;&lt; N * N &lt;&lt; " elements): ";
    for (int i = 0; i < N * N; i++) {
        cin &gt;&gt; h_B[i];
    }

    float *d_A, *d_B, *d_C;
    cudaMalloc((void**)&d_A, N * N * sizeof(float));
    cudaMalloc((void**)&d_B, N * N * sizeof(float));
    cudaMalloc((void**)&d_C, N * N * sizeof(float));

    cudaMemcpy(d_A, h_A, N * N * sizeof(float), cudaMemcpyHostToDevice);
    cudaMemcpy(d_B, h_B, N * N * sizeof(float), cudaMemcpyHostToDevice);

    dim3 blockSize(16, 16);
    dim3 gridSize((N + blockSize.x - 1) / blockSize.x, (N + blockSize.y - 1) / blockSize.y);

    matrixMultiplyKernel<<<gridSize, blockSize>>>(d_A, d_B, d_C, N);

    cudaMemcpy(h_C, d_C, N * N * sizeof(float), cudaMemcpyDeviceToHost);

    cout &lt;&lt; "Result matrix C = A * B:" &lt;&lt; endl;
    for (int i = 0; i < N; i++) {
        for (int j = 0; j < N; j++) {
            cout &lt;&lt; h_C[i * N + j] &lt;&lt; " ";
        }
        cout &lt;&lt; endl;
    }

    cudaFree(d_A);
    cudaFree(d_B);
    cudaFree(d_C);

    delete[] h_A;
    delete[] h_B;
    delete[] h_C;

    return 0;
}
    </code></pre>

    <p>To run this code, make sure your system supports CUDA and has the NVIDIA CUDA Toolkit installed.</p>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>

</body>
</html>
